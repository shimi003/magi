{% extends "base.html" %}
{% block content %}
{% csrf_token %}
<form method="post" action="/">
  <select name="ym">
    {% for ym in ym_list %} {# ym_list = ['2018/10', '2018/11', ...] #}
      <option value="{{ ym }}">{{ ym }}</option>
    {% endfor %}
  </select>
  <select name="account">
    {% for key, valuelist in listgroup.items %}
      <optgroup label="{{ key }}">
        {% for val in valuelist %}
          <option value='{{ val.uid }}'>
            {{ val.label }}/{{ val.value }}
          </option>
        {% endfor %}
      </optgroup>
    {% endfor %}
  </select>
  <input type="button" value="ok" onclick="move()"/>
</form>
<div>
  <canvas id="myChart"></canvas>
</div>
{% endblock %}

{% block extra_js %}
  <script type="text/javascript">
    function move(){
      window.location.href="{% url 'suii' %}"
        + $("select[name='ym']").val()
        + '/' + $("select[name='account']").val();
    };
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
  <script>
    new Chart(document.getElementById("myChart"),{
      type: "line",
      data: {
        labels: {{ label | safe }},
        datasets: [{
          label: {% if acc_name %}"{{ acc_name }}",{% else %}"現金",{% endif %}
          fill: false,
          borderColor: "rgba(0,135,135,10)",
          data: {{ suii_list }},
        }],
      },
    });
  </script>
{% endblock %}
